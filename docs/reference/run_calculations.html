<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Run calculations <U+2014> run_calculations <e2><80><a2> prioritizrutils</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">prioritizrutils</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/prioritizr/prioritizrutils">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run calculations</h1>
    </div>

    
    <p>Execute preliminary calculations in a conservation problem and store the
results for later reuse. This function is useful when creating slightly 
different versions of the same conservation planning problem that involve 
the same constraints, because means that the same calculations will not be 
run multiple times.</p>
    

    <pre><span class='fu'>run_calculations</span>(<span class='no'>x</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>x</dt>
      <dd><code><a href='ConservationProblem.html'>ConservationProblem</a></code> object</dd>
    </dl>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>None.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function is used for the effect of modifying the input
  <code><a href='ConservationProblem.html'>ConservationProblem</a></code> object. As such, it does not return
  anything. To use this function with <code><a href='%>%.html'>pipe</a></code> operators, use the
  <code>%T&gt;%</code> operator and not the <code>%&gt;%</code> operator.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='%T>%.html'>tee</a></code>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Let us imagine a scenario where we wanted to understand the effect of </span>
<span class='co'># setting different targets on our solution.</span>

<span class='co'># create a conservation problem with no targets</span>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='problem.html'>problem</a></span>(<span class='no'>sim_pu_raster</span>, <span class='no'>sim_features</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='objectives.html'>add_minimum_set_objective</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='add_boundary_constraint.html'>add_boundary_constraint</a></span>(<span class='fl'>10</span>, <span class='fl'>0.5</span>)

<span class='co'># create a copies of p and add targets</span>
<span class='no'>p1</span> <span class='kw'>&lt;-</span> <span class='no'>p</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='targets.html'>add_relative_targets</a></span>(<span class='fl'>0.1</span>)
<span class='no'>p2</span> <span class='kw'>&lt;-</span> <span class='no'>p</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='targets.html'>add_relative_targets</a></span>(<span class='fl'>0.2</span>)
<span class='no'>p3</span> <span class='kw'>&lt;-</span> <span class='no'>p</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='targets.html'>add_relative_targets</a></span>(<span class='fl'>0.3</span>)

<span class='co'># now solve each of the different problems and record the time spent </span>
<span class='co'># solving them</span>
<span class='no'>s1</span> <span class='kw'>&lt;-</span> <span class='fu'>system.time</span>({<span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p1</span>); <span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p2</span>); <span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p3</span>)})</div><div class='output co'>#&gt; Optimize a model with 295 rows, 235 columns and 1030 nonzeros
#&gt; Variable types: 0 continuous, 235 integer (235 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [1e-01, 1e+00]
#&gt;   Objective range  [1e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [2e+00, 7e+00]
#&gt; Found heuristic solution: objective 3371.3
#&gt; Presolve time: 0.01s
#&gt; Presolved: 295 rows, 235 columns, 1030 nonzeros
#&gt; Variable types: 0 continuous, 235 integer (235 binary)
#&gt; Presolved: 295 rows, 235 columns, 1030 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 1.808671e+03, 211 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 1808.67141    0   15 3371.29701 1808.67141  46.4%     -    0s
#&gt; H    0     0                    2010.0617996 1808.67141  10.0%     -    0s
#&gt; H    0     0                    1836.5292052 1808.67141  1.52%     -    0s
#&gt; 
#&gt; Explored 0 nodes (211 simplex iterations) in 0.04 seconds
#&gt; Thread count was 1 (of 2 available processors)
#&gt; 
#&gt; Solution count 3: 1836.53 2010.06 3371.3 
#&gt; Pool objective bound 1808.67
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 1.836529205214e+03, best bound 1.808671409851e+03, gap 1.5169%
#&gt; Optimize a model with 295 rows, 235 columns and 1030 nonzeros
#&gt; Variable types: 0 continuous, 235 integer (235 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [1e-01, 1e+00]
#&gt;   Objective range  [1e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [5e+00, 1e+01]
#&gt; Found heuristic solution: objective 6216.37
#&gt; Presolve time: 0.01s
#&gt; Presolved: 295 rows, 235 columns, 1030 nonzeros
#&gt; Variable types: 0 continuous, 235 integer (235 binary)
#&gt; Presolved: 295 rows, 235 columns, 1030 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.625936e+03, 210 iterations, 0.01 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3625.93604    0   16 6216.37471 3625.93604  41.7%     -    0s
#&gt; H    0     0                    3687.7793461 3625.93604  1.68%     -    0s
#&gt; 
#&gt; Explored 0 nodes (210 simplex iterations) in 0.02 seconds
#&gt; Thread count was 1 (of 2 available processors)
#&gt; 
#&gt; Solution count 2: 3687.78 6216.37 
#&gt; Pool objective bound 3625.94
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.687779346069e+03, best bound 3.625936037324e+03, gap 1.6770%
#&gt; Optimize a model with 295 rows, 235 columns and 1030 nonzeros
#&gt; Variable types: 0 continuous, 235 integer (235 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [1e-01, 1e+00]
#&gt;   Objective range  [1e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [7e+00, 2e+01]
#&gt; Found heuristic solution: objective 8468.96
#&gt; Presolve time: 0.01s
#&gt; Presolved: 295 rows, 235 columns, 1030 nonzeros
#&gt; Variable types: 0 continuous, 235 integer (235 binary)
#&gt; Presolved: 295 rows, 235 columns, 1030 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 5.452273e+03, 191 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 5452.27334    0   17 8468.96213 5452.27334  35.6%     -    0s
#&gt; H    0     0                    5894.0843471 5452.27334  7.50%     -    0s
#&gt; 
#&gt; Explored 0 nodes (191 simplex iterations) in 0.02 seconds
#&gt; Thread count was 1 (of 2 available processors)
#&gt; 
#&gt; Solution count 2: 5894.08 8468.96 
#&gt; Pool objective bound 5452.27
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 5.894084347075e+03, best bound 5.452273338614e+03, gap 7.4958%</div><div class='input'>
<span class='co'># This approach is inefficient. Since these problems all share the same </span>
<span class='co'># planning units it is actually performing the same calculations three times.</span>
<span class='co'># To avoid this, we can use the "run_calculations" function before creating </span>
<span class='co'># the copies. Normally, R runs the calculations just before solving the </span>
<span class='co'># problem</span>

<span class='co'># recreate a conservation problem with no targets and tell R run the</span>
<span class='co'># preliminary calculations. Note how we use the \%T&gt;\% operator here.</span>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='problem.html'>problem</a></span>(<span class='no'>sim_pu_raster</span>, <span class='no'>sim_features</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='objectives.html'>add_minimum_set_objective</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='add_boundary_constraint.html'>add_boundary_constraint</a></span>(<span class='fl'>10</span>, <span class='fl'>0.5</span>) <span class='kw'>%T&gt;%</span>
  <span class='fu'>run_calculations</span>()

<span class='co'># create a copies of p and add targets just like before</span>
<span class='no'>p1</span> <span class='kw'>&lt;-</span> <span class='no'>p</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='targets.html'>add_relative_targets</a></span>(<span class='fl'>0.1</span>)
<span class='no'>p2</span> <span class='kw'>&lt;-</span> <span class='no'>p</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='targets.html'>add_relative_targets</a></span>(<span class='fl'>0.2</span>)
<span class='no'>p3</span> <span class='kw'>&lt;-</span> <span class='no'>p</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='targets.html'>add_relative_targets</a></span>(<span class='fl'>0.3</span>)

<span class='co'># solve each of the different problems and record the time spent </span>
<span class='co'># solving them</span>
<span class='no'>s2</span> <span class='kw'>&lt;-</span> <span class='fu'>system.time</span>({<span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p1</span>); <span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p2</span>); <span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p3</span>)})</div><div class='output co'>#&gt; Optimize a model with 295 rows, 235 columns and 1030 nonzeros
#&gt; Variable types: 0 continuous, 235 integer (235 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [1e-01, 1e+00]
#&gt;   Objective range  [1e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [2e+00, 7e+00]
#&gt; Found heuristic solution: objective 3371.3
#&gt; Presolve time: 0.01s
#&gt; Presolved: 295 rows, 235 columns, 1030 nonzeros
#&gt; Variable types: 0 continuous, 235 integer (235 binary)
#&gt; Presolved: 295 rows, 235 columns, 1030 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 1.808671e+03, 211 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 1808.67141    0   15 3371.29701 1808.67141  46.4%     -    0s
#&gt; H    0     0                    2010.0617996 1808.67141  10.0%     -    0s
#&gt; H    0     0                    1836.5292052 1808.67141  1.52%     -    0s
#&gt; 
#&gt; Explored 0 nodes (211 simplex iterations) in 0.03 seconds
#&gt; Thread count was 1 (of 2 available processors)
#&gt; 
#&gt; Solution count 3: 1836.53 2010.06 3371.3 
#&gt; Pool objective bound 1808.67
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 1.836529205214e+03, best bound 1.808671409851e+03, gap 1.5169%
#&gt; Optimize a model with 295 rows, 235 columns and 1030 nonzeros
#&gt; Variable types: 0 continuous, 235 integer (235 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [1e-01, 1e+00]
#&gt;   Objective range  [1e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [5e+00, 1e+01]
#&gt; Found heuristic solution: objective 6216.37
#&gt; Presolve time: 0.01s
#&gt; Presolved: 295 rows, 235 columns, 1030 nonzeros
#&gt; Variable types: 0 continuous, 235 integer (235 binary)
#&gt; Presolved: 295 rows, 235 columns, 1030 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.625936e+03, 210 iterations, 0.01 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3625.93604    0   16 6216.37471 3625.93604  41.7%     -    0s
#&gt; H    0     0                    3687.7793461 3625.93604  1.68%     -    0s
#&gt; 
#&gt; Explored 0 nodes (210 simplex iterations) in 0.02 seconds
#&gt; Thread count was 1 (of 2 available processors)
#&gt; 
#&gt; Solution count 2: 3687.78 6216.37 
#&gt; Pool objective bound 3625.94
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.687779346069e+03, best bound 3.625936037324e+03, gap 1.6770%
#&gt; Optimize a model with 295 rows, 235 columns and 1030 nonzeros
#&gt; Variable types: 0 continuous, 235 integer (235 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [1e-01, 1e+00]
#&gt;   Objective range  [1e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [7e+00, 2e+01]
#&gt; Found heuristic solution: objective 8468.96
#&gt; Presolve time: 0.01s
#&gt; Presolved: 295 rows, 235 columns, 1030 nonzeros
#&gt; Variable types: 0 continuous, 235 integer (235 binary)
#&gt; Presolved: 295 rows, 235 columns, 1030 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 5.452273e+03, 191 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 5452.27334    0   17 8468.96213 5452.27334  35.6%     -    0s
#&gt; H    0     0                    5894.0843471 5452.27334  7.50%     -    0s
#&gt; 
#&gt; Explored 0 nodes (191 simplex iterations) in 0.02 seconds
#&gt; Thread count was 1 (of 2 available processors)
#&gt; 
#&gt; Solution count 2: 5894.08 8468.96 
#&gt; Pool objective bound 5452.27
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 5.894084347075e+03, best bound 5.452273338614e+03, gap 7.4958%</div><div class='input'>
<span class='co'># now lets compare the times</span>
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>s1</span>) <span class='co'># time spent without running preliminary calculations</span></div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   1.254   0.197   1.466 </div><div class='input'><span class='fu'><a href='print.html'>print</a></span>(<span class='no'>s2</span>) <span class='co'># time spent after running preliminary calculations</span></div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   1.067   0.185   1.265 </div><div class='input'>
<span class='co'># As we can see, we can save a lot of time by running the preliminary </span>
<span class='co'># calculations before making copies of the problem with slightly</span>
<span class='co'># different constraints.</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Jeffrey O Hanson, Richard Schuster, Matthew Strimas-Mackey, Peter Arcese, Joeseph Bennett.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
